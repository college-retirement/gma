angular.module("gmaApp",["gmaApp.filters","ngRoute","ngAnimate","ui.utils","ui.bootstrap","persona"]),angular.module("gmaApp.filters",[]),angular.module("gmaApp").config(["$routeProvider",function(a){a.when("/",{templateUrl:"assets/views/home.html",controller:"MainCtrl"}).when("/initial",{templateUrl:"assets/views/initialData.html",controller:"InitialDataController"}).when("/profile",{templateUrl:"assets/views/initialData.html",controller:"ProfileCtrl"}).when("/register",{templateUrl:"assets/views/register.html",controller:"RegisterCtrl"}).when("/drafts/:draft",{templateUrl:"assets/views/initialData.html",controller:"ProfileCtrl"}).when("/admin",{templateUrl:"assets/views/admin/home.html",controller:"AdminCtrl"}).when("/admin/profiles",{templateUrl:"assets/views/admin/profiles/list.html",controller:"AdminListCtrl"}).when("/admin/profiles/:profile",{templateUrl:"assets/views/admin/profiles/view.html",controller:"AdminViewCtrl",reloadOnSearch:!1}).otherwise("/")}]),angular.module("gmaApp").controller("AppCtrl",["$rootScope","$scope","Persona",function(){}]),angular.module("gmaApp").controller("MainCtrl",["$rootScope","$scope","Persona","$timeout","$http",function(a,b,c,d,e){c.status(),b.drafts=[],b.login=function(){b.$emit("loginClick")},b.getUser=function(){return c.getUser()},b.getDrafts=function(){e.get("/drafts").then(function(a){b.drafts=a.data.drafts})},b.getUser()!==!1&&b.getDrafts(),b.$watch("getUser()",function(){e.get("/drafts").then(function(a){b.drafts=a.data.drafts})}),b.draftDelete=function(a){e.delete("/drafts/"+a._id).then(function(){toastr.success("Draft deleted successfully."),e.get("/drafts").then(function(a){b.drafts=a.data.drafts})})}}]),angular.module("gmaApp").controller("PersonaCtrl",["$rootScope","$scope","Persona",function(a,b,c){b.login=function(){c.verify()},b.logout=function(){c.logout()},b.status=function(){c.status()},b.getUser=function(){return c.getUser()},a.$on("loginClick",function(){b.login()})}]),angular.module("gmaApp").controller("ExtendedProfileController",["$rootScope","$scope",function(){}]),angular.module("gmaApp").controller("ProfileCtrl",["$scope","$http","$route","$location","Persona","states","AssetTypes","OwnershipTypes","LiabilityTypes","RetirementTypes",function(a,b,c,d,e,f,g,h,i,j){e.status(),a.getUser=function(){return e.getUser()},c.current.params.hasOwnProperty("draft")&&b.get("/drafts/"+c.current.params.draft).then(function(b){a.student=b.data,a.continue=!0,a.draftLoaded=!0}),a.states=f,a.currentSchool=null,a.collegeList={},a.collegesLoading=!1,a.ownershipTypes=h,a.liabilityTypes=i,a.assetTypes=g,a.retirementTypes=j,a.stronghold={},a.student={email:null,dependents:0,livingArrangement:null,income:{earnedIncome:0,unearnedIncome:0,taxPaid:0,agi:0,itemizedDeductions:0,ssBenefits:0,iraContribution:0},schools:[],family:{monthlyHouseholdExpense:0,contributionAbility:0,members:[],realEstate:[],assets:[],liabilities:[],retirement:[],home:{price:0,value:0,propertyTax:0}},guardian:{income:{current:0,anticipated:0,retirement:0,ssBenefits:0}},parents:{income:{father:{current:0,anticipated:0,retirement:0,ssBenefits:0},mother:{current:0,anticipated:0,retirement:0,ssBenefits:0},combined:{other:0,untaxed:0,childSupport:{received:0,paid:0},housing:0,medical:0,deductions:0,taxPaid:0,agi:0}}}},a.$watch("currentSchool",function(){""!=a.currentSchool&&"object"!=typeof a.currentSchool&&(a.collegesLoading=!0,b.post("/colleges.json",{name:a.currentSchool}).then(function(b){a.collegeList=b.data,a.collegesLoading=!1}))}),a.addSchool=function(){a.student.schools.push(a.currentSchool),a.currentSchool=null},a.updateSchool=function(b){a.currentSchool=b},a.deleteSchool=function(b){a.student.schools.splice(b,1)},a.addFamily=function(){a.student.family.members.push({student:!1})},a.deleteFamily=function(b){a.student.family.members.splice(b,1)},a.addProperty=function(){a.student.family.realEstate.push({})},a.deleteProperty=function(b){a.student.family.realEstate.splice(b,1)},a.addAsset=function(){a.student.family.assets.push({})},a.deleteAsset=function(b){a.student.family.assets.splice(b,1)},a.addLiability=function(){a.student.family.liabilities.push({})},a.deleteLiability=function(b){a.student.family.liabilities.splice(b,1)},a.addRetirement=function(){a.student.family.retirement.push({})},a.deleteRetirement=function(b){a.student.family.retirement.splice(b,1)},a.submitProfile=function(){var c=!1;jQuery(".has-error").removeClass("has-error"),jQuery(".ng-invalid").each(function(){c=!0,jQuery(this).parent(".control").parent(".form-group").addClass("has-error")}),jQuery(".btn.ng-invalid").each(function(){c=!0,jQuery(this).parent(".btn-group").parent(".control").parent(".form-group").addClass("has-error")}),jQuery(".input-group>.ng-invalid").each(function(){c=!0,jQuery(this).parent(".input-group").parent(".control").parent(".form-group").addClass("has-error")}),jQuery(".ng-invalid:not(form)").first().focus(),a.submit=!0,c||b.post("/profiles",a.student).success(function(){a.finished=!0}).error(function(){toastr.error("Unable to submit profile.")})},a.saveDraft=function(){b.post("/drafts",a.student).success(function(b){toastr.success("Draft saved successfully!"),a.student=b}).error(function(){toastr.warning("There were issues saving your draft.")})}}]),angular.module("gmaApp").controller("RegisterCtrl",["$scope","$http","$location","Persona",function(a,b){a.done=!1,a.submit=function(){var c=!1;jQuery(".has-error").removeClass("has-error"),jQuery(".ng-invalid").each(function(){c=!0,jQuery(this).parent(".control").parent(".form-group").addClass("has-error")}),jQuery(".btn.ng-invalid").each(function(){c=!0,jQuery(this).parent(".btn-group").parent(".control").parent(".form-group").addClass("has-error")}),jQuery(".input-group>.ng-invalid").each(function(){c=!0,jQuery(this).parent(".input-group").parent(".control").parent(".form-group").addClass("has-error")}),jQuery(".ng-invalid:not(form)").first().focus(),a.submitted=!0,c||b.post("/accounts",a.user).success(function(){a.done=!0}).error(function(a){a.hasOwnProperty("messages")&&a.messages.hasOwnProperty("duplicate_email")?toastr.error("There is an account with this email already."):toastr.error("Unable to create account.")})}}]),angular.module("gmaApp").controller("AdminCtrl",["$scope","Persona",function(){}]),angular.module("gmaApp").controller("AdminListCtrl",["$scope","Persona","$http","$location",function(a,b,c,d){b.status(),c.get("/admin/profiles").then(function(b){a.profiles=b.data}),a.viewProfile=function(a){d.path("/admin/profiles/"+a._id)}}]),angular.module("gmaApp").controller("AdminViewCtrl",["$scope","$route","$http","$location","Persona",function(a,b,c,d,e){e.status(),a.mode=d.search().mode;var f=b.current.params.profile;c.get("/admin/profiles/"+f).then(function(b){a.student=b.data}),a.$on("$routeUpdate",function(){a.mode=d.search().mode}),a.partial=function(){switch(a.mode){case"edit":return"assets/views/admin/profiles/partial/edit.html";case"css":return"assets/views/admin/profiles/partial/css.html";case"fafsa":return"assets/views/admin/profiles/partial/fafsa.html";case"report":default:return"assets/views/admin/profiles/partial/report.html"}},a.changeMode=function(a){d.search("mode",a)}}]),angular.module("gmaApp").controller("DraftCtrl",["$scope","$http","Persona","$location","states","$route",function(a,b,c,d,e,f){c.status(),a.states=e,a.currentSchool=null,a.collegeList={},a.collegesLoading=!1,a.$watch("currentSchool",function(){""!=a.currentSchool&&"object"!=typeof a.currentSchool&&(a.collegesLoading=!0,b.post("/colleges.json",{name:a.currentSchool}).then(function(b){a.collegeList=b.data,a.collegesLoading=!1}))}),a.ownershipTypes=["Personally","Jointly","LLC","S-Corp","Partnership","C-Corp","Other"],a.liabilityTypes=["Car Loan","Credit Card","First Mortgage","Home Equity Line Of Credit","Life Insurance Premium","Other","Second Mortgage"],a.assetTypes=["Annuities (Non Qualified - Not Retirement)","Bonds (including Tax - Exempt)","Business Assets","Cash, Savings","Certificates of Deposit","Checking","Money Market Funds","Mutual Funds","Other Assets","Pre-Paid Tuition Accounts (529 Plans)","Sibling Assets Held By Parents","Stocks","Treasury Bills"],a.retirementTypes=["401(k)","403(b)","IRA","Keogh/SEP/Simple","Pension Fund","Qualified Annuities","Rollover"],a.student={email:c.getUser().email,schools:[],family:{members:[],realEstate:[],assets:[],liabilities:[],retirement:[]}},b.get("/drafts/"+f.current.params.draft).then(function(b){a.student=b.data,a.continue=!0,a.draftLoaded=!0}),a.addSchool=function(){a.student.schools.push(a.currentSchool),a.currentSchool=null},a.deleteSchool=function(b){a.student.schools.splice(b,1)},a.updateSchool=function(b){a.currentSchool=b},a.updateOrCreateAccount=function(){var d={email:c.getUser().email||a.student.email,name:{first:a.student.name.first,middle:a.student.name.middle,last:a.student.name.last},gender:a.student.gender,phone:a.student.phone};b.put("/account",d).then(function(){})},a.saveDraft=function(){b.put("/drafts",a.student)},a.addFamily=function(){a.student.family.members.push({student:!1})},a.addProperty=function(){a.student.family.realEstate.push({})},a.addAsset=function(){a.student.family.assets.push({})},a.addLiability=function(){a.student.family.liabilities.push({})},a.addRetirement=function(){a.student.family.retirement.push({})},a.deleteFamily=function(b){a.student.family.members.splice(b,1)},a.deleteProperty=function(b){a.student.family.realEstate.splice(b,1)},a.deleteAsset=function(b){a.student.family.assets.splice(b,1)},a.deleteLiability=function(b){a.student.family.liabilities.splice(b,1)},a.deleteRetirement=function(b){a.student.family.retirement.splice(b,1)},a.submitProfile=function(){jQuery(".has-error").removeClass("has-error"),jQuery(".ng-invalid").each(function(){jQuery(this).parent(".control").parent(".form-group").addClass("has-error")}),jQuery(".btn.ng-invalid").each(function(){jQuery(this).parent(".btn-group").parent(".control").parent(".form-group").addClass("has-error")}),jQuery(".input-group>.ng-invalid").each(function(){jQuery(this).parent(".input-group").parent(".control").parent(".form-group").addClass("has-error")}),jQuery(".ng-invalid:not(form)").first().focus(),a.submit=!0,jQuery("form").hasClass(".ng-invalid")||b.post("/profiles",a.student)}}]),angular.module("gmaApp.filters").filter("dob",function(){return function(a){if(void 0!=a){var b=a;return b.substr(0,2)+"/"+b.substr(2,2)+"/"+b.substr(4)}}}),angular.module("gmaApp.filters").filter("fullState",function(){return function(a){var b=[{name:"Alabama",abbreviation:"AL"},{name:"Alaska",abbreviation:"AK"},{name:"American Samoa",abbreviation:"AS"},{name:"Arizona",abbreviation:"AZ"},{name:"Arkansas",abbreviation:"AR"},{name:"California",abbreviation:"CA"},{name:"Colorado",abbreviation:"CO"},{name:"Connecticut",abbreviation:"CT"},{name:"Delaware",abbreviation:"DE"},{name:"District Of Columbia",abbreviation:"DC"},{name:"Federated States Of Micronesia",abbreviation:"FM"},{name:"Florida",abbreviation:"FL"},{name:"Georgia",abbreviation:"GA"},{name:"Guam",abbreviation:"GU"},{name:"Hawaii",abbreviation:"HI"},{name:"Idaho",abbreviation:"ID"},{name:"Illinois",abbreviation:"IL"},{name:"Indiana",abbreviation:"IN"},{name:"Iowa",abbreviation:"IA"},{name:"Kansas",abbreviation:"KS"},{name:"Kentucky",abbreviation:"KY"},{name:"Louisiana",abbreviation:"LA"},{name:"Maine",abbreviation:"ME"},{name:"Marshall Islands",abbreviation:"MH"},{name:"Maryland",abbreviation:"MD"},{name:"Massachusetts",abbreviation:"MA"},{name:"Michigan",abbreviation:"MI"},{name:"Minnesota",abbreviation:"MN"},{name:"Mississippi",abbreviation:"MS"},{name:"Missouri",abbreviation:"MO"},{name:"Montana",abbreviation:"MT"},{name:"Nebraska",abbreviation:"NE"},{name:"Nevada",abbreviation:"NV"},{name:"New Hampshire",abbreviation:"NH"},{name:"New Jersey",abbreviation:"NJ"},{name:"New Mexico",abbreviation:"NM"},{name:"New York",abbreviation:"NY"},{name:"North Carolina",abbreviation:"NC"},{name:"North Dakota",abbreviation:"ND"},{name:"Northern Mariana Islands",abbreviation:"MP"},{name:"Ohio",abbreviation:"OH"},{name:"Oklahoma",abbreviation:"OK"},{name:"Oregon",abbreviation:"OR"},{name:"Palau",abbreviation:"PW"},{name:"Pennsylvania",abbreviation:"PA"},{name:"Puerto Rico",abbreviation:"PR"},{name:"Rhode Island",abbreviation:"RI"},{name:"South Carolina",abbreviation:"SC"},{name:"South Dakota",abbreviation:"SD"},{name:"Tennessee",abbreviation:"TN"},{name:"Texas",abbreviation:"TX"},{name:"Utah",abbreviation:"UT"},{name:"Vermont",abbreviation:"VT"},{name:"Virgin Islands",abbreviation:"VI"},{name:"Virginia",abbreviation:"VA"},{name:"Washington",abbreviation:"WA"},{name:"West Virginia",abbreviation:"WV"},{name:"Wisconsin",abbreviation:"WI"},{name:"Wyoming",abbreviation:"WY"}],c=jQuery.grep(b,function(b){return b.abbreviation===a});return c.length>0?c[0].name:"State"}}),angular.module("gmaApp.filters").filter("gender",function(){return function(a){var b=a;return"M"==b?"Male":"Female"}}),angular.module("gmaApp.filters").filter("marital",function(){return function(a){if(void 0!=a)switch(a){case 0:return"Never Married";case 1:return"Separated";case 2:return"Widowed";case 3:return"Divorced";case 4:return"Remarried";case 5:return"Married"}}}),angular.module("gmaApp.filters").filter("phone",function(){return function(a){if(void 0!=a){var b=a;return"("+b.substr(0,3)+") "+b.substr(3,3)+"-"+b.substr(6)}}}),angular.module("gmaApp.filters").filter("ssn",function(){return function(a){if(void 0!=a){var b=a;return b.substr(0,3)+"-"+b.substr(3,2)+"-"+b.substr(5)}}}),angular.module("gmaApp").service("OwnershipTypes",function(){return["Personally","Jointly","LLC","S-Corp","Partnership","C-Corp","Other"]}),angular.module("gmaApp").service("LiabilityTypes",function(){return["Car Loan","Credit Card","First Mortgage","Home Equity Line Of Credit","Life Insurance Premium","Other","Second Mortgage"]}),angular.module("gmaApp").service("AssetTypes",function(){return["Annuities (Non Qualified - Not Retirement)","Bonds (including Tax - Exempt)","Business Assets","Cash, Savings","Certificates of Deposit","Checking","Money Market Funds","Mutual Funds","Other Assets","Pre-Paid Tuition Accounts (529 Plans)","Sibling Assets Held By Parents","Stocks","Treasury Bills"]}),angular.module("gmaApp").service("RetirementTypes",function(){return["401(k)","403(b)","IRA","Keogh/SEP/Simple","Pension Fund","Qualified Annuities","Rollover"]}),angular.module("persona",[]),angular.module("persona").factory("Persona",["$http","$q",function(a,b){var c={user:{},getUser:function(){return c.user.hasOwnProperty("email")?c.user:!1},verify:function(){var d=b.defer();return navigator.id.get(function(b){a.post("/persona/verify",{assertion:b}).then(function(a){"okay"!=a.data.status?d.reject(a.data.reason):(c.user=a.data.user,d.resolve(a.data.email))})}),d.promise},logout:function(){return a.post("/persona/logout").then(function(a){return c.user={},"okay"!=a.data.status&&b.reject(a.data.reason),a.data.email})},status:function(){a.post("/persona/status").then(function(a){return c.user=a.data.user,c.user})}};return c.status(),c}]),angular.module("gmaApp").service("states",function(){var a=[{name:"Alabama",abbreviation:"AL"},{name:"Alaska",abbreviation:"AK"},{name:"American Samoa",abbreviation:"AS"},{name:"Arizona",abbreviation:"AZ"},{name:"Arkansas",abbreviation:"AR"},{name:"California",abbreviation:"CA"},{name:"Colorado",abbreviation:"CO"},{name:"Connecticut",abbreviation:"CT"},{name:"Delaware",abbreviation:"DE"},{name:"District Of Columbia",abbreviation:"DC"},{name:"Federated States Of Micronesia",abbreviation:"FM"},{name:"Florida",abbreviation:"FL"},{name:"Georgia",abbreviation:"GA"},{name:"Guam",abbreviation:"GU"},{name:"Hawaii",abbreviation:"HI"},{name:"Idaho",abbreviation:"ID"},{name:"Illinois",abbreviation:"IL"},{name:"Indiana",abbreviation:"IN"},{name:"Iowa",abbreviation:"IA"},{name:"Kansas",abbreviation:"KS"},{name:"Kentucky",abbreviation:"KY"},{name:"Louisiana",abbreviation:"LA"},{name:"Maine",abbreviation:"ME"},{name:"Marshall Islands",abbreviation:"MH"},{name:"Maryland",abbreviation:"MD"},{name:"Massachusetts",abbreviation:"MA"},{name:"Michigan",abbreviation:"MI"},{name:"Minnesota",abbreviation:"MN"},{name:"Mississippi",abbreviation:"MS"},{name:"Missouri",abbreviation:"MO"},{name:"Montana",abbreviation:"MT"},{name:"Nebraska",abbreviation:"NE"},{name:"Nevada",abbreviation:"NV"},{name:"New Hampshire",abbreviation:"NH"},{name:"New Jersey",abbreviation:"NJ"},{name:"New Mexico",abbreviation:"NM"},{name:"New York",abbreviation:"NY"},{name:"North Carolina",abbreviation:"NC"},{name:"North Dakota",abbreviation:"ND"},{name:"Northern Mariana Islands",abbreviation:"MP"},{name:"Ohio",abbreviation:"OH"},{name:"Oklahoma",abbreviation:"OK"},{name:"Oregon",abbreviation:"OR"},{name:"Palau",abbreviation:"PW"},{name:"Pennsylvania",abbreviation:"PA"},{name:"Puerto Rico",abbreviation:"PR"},{name:"Rhode Island",abbreviation:"RI"},{name:"South Carolina",abbreviation:"SC"},{name:"South Dakota",abbreviation:"SD"},{name:"Tennessee",abbreviation:"TN"},{name:"Texas",abbreviation:"TX"},{name:"Utah",abbreviation:"UT"},{name:"Vermont",abbreviation:"VT"},{name:"Virgin Islands",abbreviation:"VI"},{name:"Virginia",abbreviation:"VA"},{name:"Washington",abbreviation:"WA"},{name:"West Virginia",abbreviation:"WV"},{name:"Wisconsin",abbreviation:"WI"},{name:"Wyoming",abbreviation:"WY"}];return a});